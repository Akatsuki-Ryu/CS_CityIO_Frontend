{"version":3,"sources":["17_CS_cityIO_Frontend/lib/three/TrackballControls.js"],"names":["THREE","TrackballControls","object","domElement","_this","STATE","NONE","ROTATE","ZOOM","PAN","TOUCH_ROTATE","TOUCH_ZOOM_PAN","undefined","document","enabled","screen","left","top","width","height","rotateSpeed","zoomSpeed","panSpeed","noRotate","noZoom","noPan","staticMoving","dynamicDampingFactor","minDistance","maxDistance","Infinity","keys","target","Vector3","EPS","lastPosition","_state","_prevState","_eye","_movePrev","Vector2","_moveCurr","_lastAxis","_lastAngle","_zoomStart","_zoomEnd","_touchZoomDistanceStart","_touchZoomDistanceEnd","_panStart","_panEnd","target0","clone","position0","position","up0","up","changeEvent","type","startEvent","endEvent","handleResize","window","innerWidth","innerHeight","box","getBoundingClientRect","d","ownerDocument","documentElement","pageXOffset","clientLeft","pageYOffset","clientTop","handleEvent","event","getMouseOnScreen","vector","pageX","pageY","set","getMouseOnCircle","rotateCamera","axis","quaternion","Quaternion","eyeDirection","objectUpDirection","objectSidewaysDirection","moveDirection","angle","x","y","length","copy","sub","normalize","crossVectors","setLength","add","setFromAxisAngle","applyQuaternion","Math","sqrt","zoomCamera","factor","multiplyScalar","panCamera","mouseChange","objectUp","pan","lengthSq","cross","subVectors","checkDistances","addVectors","update","lookAt","distanceToSquared","dispatchEvent","reset","keydown","removeEventListener","keyCode","keyup","addEventListener","mousedown","preventDefault","stopPropagation","button","mousemove","mouseup","mousewheel","deltaMode","deltaY","touchstart","touches","dx","dy","touchmove","touchend","contextmenu","dispose","prototype","Object","create","EventDispatcher","constructor"],"mappings":"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","file":"TrackballControls.4ce29567.map","sourcesContent":["/**\n * @author Eberhard Graether / http://egraether.com/\n * @author Mark Lundin \t/ http://mark-lundin.com\n * @author Simone Manini / http://daron1337.github.io\n * @author Luca Antiga \t/ http://lantiga.github.io\n */\n\nTHREE.TrackballControls = function ( object, domElement ) {\n\n\tvar _this = this;\n\tvar STATE = { NONE: - 1, ROTATE: 0, ZOOM: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_ZOOM_PAN: 4 };\n\n\tthis.object = object;\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// API\n\n\tthis.enabled = true;\n\n\tthis.screen = { left: 0, top: 0, width: 0, height: 0 };\n\n\tthis.rotateSpeed = 1.0;\n\tthis.zoomSpeed = 1.2;\n\tthis.panSpeed = 0.3;\n\n\tthis.noRotate = false;\n\tthis.noZoom = false;\n\tthis.noPan = false;\n\n\tthis.staticMoving = false;\n\tthis.dynamicDampingFactor = 0.2;\n\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\tthis.keys = [ 65 /*A*/, 83 /*S*/, 68 /*D*/ ];\n\n\t// internals\n\n\tthis.target = new THREE.Vector3();\n\n\tvar EPS = 0.000001;\n\n\tvar lastPosition = new THREE.Vector3();\n\n\tvar _state = STATE.NONE,\n\t_prevState = STATE.NONE,\n\n\t_eye = new THREE.Vector3(),\n\n\t_movePrev = new THREE.Vector2(),\n\t_moveCurr = new THREE.Vector2(),\n\n\t_lastAxis = new THREE.Vector3(),\n\t_lastAngle = 0,\n\n\t_zoomStart = new THREE.Vector2(),\n\t_zoomEnd = new THREE.Vector2(),\n\n\t_touchZoomDistanceStart = 0,\n\t_touchZoomDistanceEnd = 0,\n\n\t_panStart = new THREE.Vector2(),\n\t_panEnd = new THREE.Vector2();\n\n\t// for reset\n\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.up0 = this.object.up.clone();\n\n\t// events\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\n\t// methods\n\n\tthis.handleResize = function () {\n\n\t\tif ( this.domElement === document ) {\n\n\t\t\tthis.screen.left = 0;\n\t\t\tthis.screen.top = 0;\n\t\t\tthis.screen.width = window.innerWidth;\n\t\t\tthis.screen.height = window.innerHeight;\n\n\t\t} else {\n\n\t\t\tvar box = this.domElement.getBoundingClientRect();\n\t\t\t// adjustments come from similar code in the jquery offset() function\n\t\t\tvar d = this.domElement.ownerDocument.documentElement;\n\t\t\tthis.screen.left = box.left + window.pageXOffset - d.clientLeft;\n\t\t\tthis.screen.top = box.top + window.pageYOffset - d.clientTop;\n\t\t\tthis.screen.width = box.width;\n\t\t\tthis.screen.height = box.height;\n\n\t\t}\n\n\t};\n\n\tthis.handleEvent = function ( event ) {\n\n\t\tif ( typeof this[ event.type ] == 'function' ) {\n\n\t\t\tthis[ event.type ]( event );\n\n\t\t}\n\n\t};\n\n\tvar getMouseOnScreen = ( function () {\n\n\t\tvar vector = new THREE.Vector2();\n\n\t\treturn function getMouseOnScreen( pageX, pageY ) {\n\n\t\t\tvector.set(\n\t\t\t\t( pageX - _this.screen.left ) / _this.screen.width,\n\t\t\t\t( pageY - _this.screen.top ) / _this.screen.height\n\t\t\t);\n\n\t\t\treturn vector;\n\n\t\t};\n\n\t}() );\n\n\tvar getMouseOnCircle = ( function () {\n\n\t\tvar vector = new THREE.Vector2();\n\n\t\treturn function getMouseOnCircle( pageX, pageY ) {\n\n\t\t\tvector.set(\n\t\t\t\t( ( pageX - _this.screen.width * 0.5 - _this.screen.left ) / ( _this.screen.width * 0.5 ) ),\n\t\t\t\t( ( _this.screen.height + 2 * ( _this.screen.top - pageY ) ) / _this.screen.width ) // screen.width intentional\n\t\t\t);\n\n\t\t\treturn vector;\n\n\t\t};\n\n\t}() );\n\n\tthis.rotateCamera = ( function() {\n\n\t\tvar axis = new THREE.Vector3(),\n\t\t\tquaternion = new THREE.Quaternion(),\n\t\t\teyeDirection = new THREE.Vector3(),\n\t\t\tobjectUpDirection = new THREE.Vector3(),\n\t\t\tobjectSidewaysDirection = new THREE.Vector3(),\n\t\t\tmoveDirection = new THREE.Vector3(),\n\t\t\tangle;\n\n\t\treturn function rotateCamera() {\n\n\t\t\tmoveDirection.set( _moveCurr.x - _movePrev.x, _moveCurr.y - _movePrev.y, 0 );\n\t\t\tangle = moveDirection.length();\n\n\t\t\tif ( angle ) {\n\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\n\n\t\t\t\teyeDirection.copy( _eye ).normalize();\n\t\t\t\tobjectUpDirection.copy( _this.object.up ).normalize();\n\t\t\t\tobjectSidewaysDirection.crossVectors( objectUpDirection, eyeDirection ).normalize();\n\n\t\t\t\tobjectUpDirection.setLength( _moveCurr.y - _movePrev.y );\n\t\t\t\tobjectSidewaysDirection.setLength( _moveCurr.x - _movePrev.x );\n\n\t\t\t\tmoveDirection.copy( objectUpDirection.add( objectSidewaysDirection ) );\n\n\t\t\t\taxis.crossVectors( moveDirection, _eye ).normalize();\n\n\t\t\t\tangle *= _this.rotateSpeed;\n\t\t\t\tquaternion.setFromAxisAngle( axis, angle );\n\n\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\n\n\t\t\t\t_lastAxis.copy( axis );\n\t\t\t\t_lastAngle = angle;\n\n\t\t\t} else if ( ! _this.staticMoving && _lastAngle ) {\n\n\t\t\t\t_lastAngle *= Math.sqrt( 1.0 - _this.dynamicDampingFactor );\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\n\t\t\t\tquaternion.setFromAxisAngle( _lastAxis, _lastAngle );\n\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\n\n\t\t\t}\n\n\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t};\n\n\t}() );\n\n\n\tthis.zoomCamera = function () {\n\n\t\tvar factor;\n\n\t\tif ( _state === STATE.TOUCH_ZOOM_PAN ) {\n\n\t\t\tfactor = _touchZoomDistanceStart / _touchZoomDistanceEnd;\n\t\t\t_touchZoomDistanceStart = _touchZoomDistanceEnd;\n\t\t\t_eye.multiplyScalar( factor );\n\n\t\t} else {\n\n\t\t\tfactor = 1.0 + ( _zoomEnd.y - _zoomStart.y ) * _this.zoomSpeed;\n\n\t\t\tif ( factor !== 1.0 && factor > 0.0 ) {\n\n\t\t\t\t_eye.multiplyScalar( factor );\n\n\t\t\t}\n\n\t\t\tif ( _this.staticMoving ) {\n\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t} else {\n\n\t\t\t\t_zoomStart.y += ( _zoomEnd.y - _zoomStart.y ) * this.dynamicDampingFactor;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.panCamera = ( function() {\n\n\t\tvar mouseChange = new THREE.Vector2(),\n\t\t\tobjectUp = new THREE.Vector3(),\n\t\t\tpan = new THREE.Vector3();\n\n\t\treturn function panCamera() {\n\n\t\t\tmouseChange.copy( _panEnd ).sub( _panStart );\n\n\t\t\tif ( mouseChange.lengthSq() ) {\n\n\t\t\t\tmouseChange.multiplyScalar( _eye.length() * _this.panSpeed );\n\n\t\t\t\tpan.copy( _eye ).cross( _this.object.up ).setLength( mouseChange.x );\n\t\t\t\tpan.add( objectUp.copy( _this.object.up ).setLength( mouseChange.y ) );\n\n\t\t\t\t_this.object.position.add( pan );\n\t\t\t\t_this.target.add( pan );\n\n\t\t\t\tif ( _this.staticMoving ) {\n\n\t\t\t\t\t_panStart.copy( _panEnd );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_panStart.add( mouseChange.subVectors( _panEnd, _panStart ).multiplyScalar( _this.dynamicDampingFactor ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}() );\n\n\tthis.checkDistances = function () {\n\n\t\tif ( ! _this.noZoom || ! _this.noPan ) {\n\n\t\t\tif ( _eye.lengthSq() > _this.maxDistance * _this.maxDistance ) {\n\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.maxDistance ) );\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t}\n\n\t\t\tif ( _eye.lengthSq() < _this.minDistance * _this.minDistance ) {\n\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.minDistance ) );\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.update = function () {\n\n\t\t_eye.subVectors( _this.object.position, _this.target );\n\n\t\tif ( ! _this.noRotate ) {\n\n\t\t\t_this.rotateCamera();\n\n\t\t}\n\n\t\tif ( ! _this.noZoom ) {\n\n\t\t\t_this.zoomCamera();\n\n\t\t}\n\n\t\tif ( ! _this.noPan ) {\n\n\t\t\t_this.panCamera();\n\n\t\t}\n\n\t\t_this.object.position.addVectors( _this.target, _eye );\n\n\t\t_this.checkDistances();\n\n\t\t_this.object.lookAt( _this.target );\n\n\t\tif ( lastPosition.distanceToSquared( _this.object.position ) > EPS ) {\n\n\t\t\t_this.dispatchEvent( changeEvent );\n\n\t\t\tlastPosition.copy( _this.object.position );\n\n\t\t}\n\n\t};\n\n\tthis.reset = function () {\n\n\t\t_state = STATE.NONE;\n\t\t_prevState = STATE.NONE;\n\n\t\t_this.target.copy( _this.target0 );\n\t\t_this.object.position.copy( _this.position0 );\n\t\t_this.object.up.copy( _this.up0 );\n\n\t\t_eye.subVectors( _this.object.position, _this.target );\n\n\t\t_this.object.lookAt( _this.target );\n\n\t\t_this.dispatchEvent( changeEvent );\n\n\t\tlastPosition.copy( _this.object.position );\n\n\t};\n\n\t// listeners\n\n\tfunction keydown( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\twindow.removeEventListener( 'keydown', keydown );\n\n\t\t_prevState = _state;\n\n\t\tif ( _state !== STATE.NONE ) {\n\n\t\t\treturn;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ROTATE ] && ! _this.noRotate ) {\n\n\t\t\t_state = STATE.ROTATE;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ZOOM ] && ! _this.noZoom ) {\n\n\t\t\t_state = STATE.ZOOM;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.PAN ] && ! _this.noPan ) {\n\n\t\t\t_state = STATE.PAN;\n\n\t\t}\n\n\t}\n\n\tfunction keyup( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\t_state = _prevState;\n\n\t\twindow.addEventListener( 'keydown', keydown, false );\n\n\t}\n\n\tfunction mousedown( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( _state === STATE.NONE ) {\n\n\t\t\t_state = event.button;\n\n\t\t}\n\n\t\tif ( _state === STATE.ROTATE && ! _this.noRotate ) {\n\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t} else if ( _state === STATE.ZOOM && ! _this.noZoom ) {\n\n\t\t\t_zoomStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t_zoomEnd.copy( _zoomStart );\n\n\t\t} else if ( _state === STATE.PAN && ! _this.noPan ) {\n\n\t\t\t_panStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t_panEnd.copy( _panStart );\n\n\t\t}\n\n\t\tdocument.addEventListener( 'mousemove', mousemove, false );\n\t\tdocument.addEventListener( 'mouseup', mouseup, false );\n\n\t\t_this.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction mousemove( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( _state === STATE.ROTATE && ! _this.noRotate ) {\n\n\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\n\t\t} else if ( _state === STATE.ZOOM && ! _this.noZoom ) {\n\n\t\t\t_zoomEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t} else if ( _state === STATE.PAN && ! _this.noPan ) {\n\n\t\t\t_panEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t}\n\n\t}\n\n\tfunction mouseup( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\t_state = STATE.NONE;\n\n\t\tdocument.removeEventListener( 'mousemove', mousemove );\n\t\tdocument.removeEventListener( 'mouseup', mouseup );\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction mousewheel( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.deltaMode ) {\n\n\t\t\tcase 2:\n\t\t\t\t// Zoom in pages\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.025;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\t// Zoom in lines\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.01;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// undefined, 0, assume pixels\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.00025;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( startEvent );\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction touchstart( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\tbreak;\n\n\t\t\tdefault: // 2 or more\n\t\t\t\t_state = STATE.TOUCH_ZOOM_PAN;\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t_touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t_panStart.copy( getMouseOnScreen( x, y ) );\n\t\t\t\t_panEnd.copy( _panStart );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction touchmove( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\tbreak;\n\n\t\t\tdefault: // 2 or more\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t_touchZoomDistanceEnd = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t_panEnd.copy( getMouseOnScreen( x, y ) );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction touchend( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 0:\n\t\t\t\t_state = STATE.NONE;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction contextmenu( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\tthis.dispose = function() {\n\n\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu, false );\n\t\tthis.domElement.removeEventListener( 'mousedown', mousedown, false );\n\t\tthis.domElement.removeEventListener( 'wheel', mousewheel, false );\n\n\t\tthis.domElement.removeEventListener( 'touchstart', touchstart, false );\n\t\tthis.domElement.removeEventListener( 'touchend', touchend, false );\n\t\tthis.domElement.removeEventListener( 'touchmove', touchmove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', mousemove, false );\n\t\tdocument.removeEventListener( 'mouseup', mouseup, false );\n\n\t\twindow.removeEventListener( 'keydown', keydown, false );\n\t\twindow.removeEventListener( 'keyup', keyup, false );\n\n\t};\n\n\tthis.domElement.addEventListener( 'contextmenu', contextmenu, false );\n\tthis.domElement.addEventListener( 'mousedown', mousedown, false );\n\tthis.domElement.addEventListener( 'wheel', mousewheel, false );\n\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\n\n\twindow.addEventListener( 'keydown', keydown, false );\n\twindow.addEventListener( 'keyup', keyup, false );\n\n\tthis.handleResize();\n\n\t// force an update at start\n\tthis.update();\n\n};\n\nTHREE.TrackballControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nTHREE.TrackballControls.prototype.constructor = THREE.TrackballControls;\n"]}